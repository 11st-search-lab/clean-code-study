# Clean Code 4장. 주석



우리는 코드로 의도를 표현하지 못한 뒤 실패를 만회하기 위해 주석을 사용한다. 주석 보다는 코드로 의도를 표현하는 것이 가장 좋다. 프로그래머들이 주석을 유지하고 보수하기는 현실적으로 불가능하기 때문이다. 

##### 

## 주석은 나쁜 코드를 보완하지 못한다

코드에 주석을 추가하는 일반적인 이유는 코드 품질이 나쁘기 때문이다. 

주석을 추가하는 일반적인 이유 : 코드 품질이 나쁘기 때문
주석을 달아야겠다 X -> 코드를 개선한다



## 코드로 의도를 표현하라!

확실히 코드만으로 의도를 설명하기 어려운 경우가 존재한다. 하지만 몇 초만 더 생각하면 코드로 대다수의 의도를 표현할 수 있다.  



### Bad

```js
//직원에게 복지 혜택을 받을 자격이 있는지 검사한다.
if((employee.flags & HOURLY_FLAG) && 
   (employee.age>65))
```

### Good

```js
if(employee.isEligibleForFullBenefits())
```



## 좋은 주석

주석을 달지 않는 방법이 최고의 방법이지만 그럼에도 불구하고 주석이 유익하게 쓰이는 경우를 알아보자.



### 법적인 주석

저작권 정보, 소유권 정보 등 회사의 법적인 이유로 넣는 법적인 주석



### 정보를 제공하는 주석

기본적인 정보를 주석으로 제공하는 주석

```js
//테스트 중인 Responder 인스턴스를 반환한다.
 responderInstance();
```

하지만 이 또한 함수 이름에 정보를 담는 방법으로 개선할 수 있다.

```js
reponderBeingTested();
```



### 의도를 설명하는 주석

코드를 짜면서 개발자의 결정에 깔린 의도까지 설명하는 주석

예시1)

 두 객체를 비교할 때 다른 객체보다 이 객체에 높은 우선 순위를 주기로 한 경우 아래와 같이 주석에 그 의도를 포함할 수 있다.

```js
function CompareTo(o){
  ...
  return 1; // 오른쪽 유형으므로 정렬 순위가 더 높다.
}
```



예시2) 

구체적인 의도를 설명한다.

```js
// 스레드를 대량 생성하는 방법으로 어떻게든 경쟁 조건을 만들려 시도한다.
...
for(let i = 0; i > 25000; i++){
  const widgetBuilderThread = new WidgetBuilderThread(widgetBuilder, text, parent, failFlag)
  ...
}
```



### 의미를 명료하게 밝히는 주석

모호한 인수나 반환값의 의미를 명료하게 밝히는 주석

인수나 반환값을 명확히 만드는 것이 좋지만, 그 반환 값이 표준 라이브러리나 변경하지 못하는 코드라면 의미를 명료하게 밝히는 주석이 유용하다.



### 결과를 경고하는 주석

다른 동료에게 결과를 경고할 목적의 주석

```js 
class SimpleDateFormat{
     // SimpleDateFormat은 스레드에 안전하지 못하다
    // 따라서 각 인스턴스를 독립적으로 생성해야한다.
    ....
}
```



### TODO

'앞으로 할 일'을 남겨두기 위한 주석

필요하다 여기지만 당장 구현하기 어려운 업무를 기술한다.

- 더이상 필요 없는 기능을 삭제하라는 알림 
- 누군가에게 문제를 봐달라는 요청 
- 더 좋은 이름을 떠올려달라는 부탁
- 앞으로 발생할 이벤트에 맞춰 코드를 고치라는 주의

TODO 주석은 유용한 주석이지만 이 역시 주기적으로 제거해나가는 것이 좋다.



### 중요성을 강조하는 주석 

자칫 대수롭지 않다고 여겨질 무언가의 중요성을 강조하기 위한 주석

```js
const ListItemContent = str.trim();
//여기서 trim은 정말 중요하다.trim 함수는 문자열에서 시작 공백을 제거한다
//문자열에 시작 공백이 잇으면 다른 문자열로 인식되기 때문이다.
...
```



### 공개 API에서 Javadocs

공개 API를 구현한다면 반드시 훌륭한 Javadocs을 작성해야 한다.

> Javadoc은 Java 소스 코드에서 HTML 형식의 API 문서를 생성하기 위해 Java 언어를 위해 Sun Microsystems에서 작성한 문서 생성기입니다. HTML 형식은 관련 문서를 함께 하이퍼 링크 할 수있는 편의성을 추가하는 데 사용됩니다.



## 나쁜 주석

대다수 주석이 이 범주에 속한다. 대다수 주석이 허술한 코드를 지탱하거나, 엉성한 코드를 변경하거나, 미숙한 결정을 합리화하는 것에 크게 벗어나지 못하기 때문이다.



### 주절거리는 주석

주석을 달기로 결정했다면 충분한 시간을 들여 최고의 주석을 달도록 노력해야한다. 

```js
try{
....
}
catch(IOException e) {
  //속성 파일이 없다면 기본값을 모두 메모리로 읽어 들였다는 의미다.
  }
```

이해가 안 되어 다른 모듈까지 뒤져야 하는 주석은 독자와 제대로 소통하지 못하는 주석이다.



### 같은 이야기를 중복하는 주석 

코드의 내용을 그대로 중복하는 주석

```js
//이 컴포넌트 프로세서 지연값 
const backgroundProcessDelay = -1;

//이 컴포넌트를 지원하기 위한 생명주기 이벤트
const lifeCycle = new LifecycleSupport();
```



### 오해할 여지가 있는 주석 

실제 동작과 살짝 다른 정보로 달려있는 주석 

```js
// this.closed가 true일 때 반환되는 유틸리티 메서드다.
// 타임아웃에 도달하면 예외를 던진다.
function waitForClose(timeoutMillis){
  ...
   if(!closed){
      wait(timeoutMillis);
      if(!closed){
        throw new Error("MockResponseSender could not be closed");
      }
   ...   
   }

```

- this.closed가 true로 변하는 순간에 메서드는 반환되지 않는다. This.closed가 true여야 메서드는 반환된다. 
- 아니면 무조건 타임아웃을 기다렸다 this.closed가 그래도 true가 아니면 예외를 던진다.

주석을 본 동료가 this.closed가 true로 변하는 순간에 함수가 반환되리라는 오해를 할 수 있다. 



### 의무적으로 다는 주석

모든 함수에 주석을 달아야 되는 의무감에 다는 주석

이런 주석은 코드를 복잡하게 만들며, 오해, 혼동, 무질서를 초래한다.



### 이력을 기록하는 주석 

모듈을 편집할 때마다 모듈 첫 머리에 추가하는 주석

과거에는 소스 코드 관리 시스템이 없었기에 모든 모듈 첫머리에 변경 이력을 기록하고 관리하는 관례가 바람직했다.

하지만 이제는 혼란만 가중할 뿐이기에 제거하는 것이 좋다.



```js
//변경 이력 (11-Oct-2001 부터)
//-----------------------------
// 11-Oct-2001: 클래스를 다시 정리하고 새로운 패키지인 
//               com.jrefinery.data로 옮겼다 (DG);
.
.
.
```



### 있으나 마나한 주석

너무 당연한 사실을 언급하며 새로운 정보를 제공하지 못하는 주석

```js
// 기본 생성자
function AnnualDateRule() {

}

//월 중 일자
let dayOfMonth;
```



### 무서운 잡음

수행 하는 목적 없이 작성된 주석

```js
//The name
let name;

//The version
let version;
```



### 함수나 변수로 표현할 수 있다면 주석을 달지 마라

주석이 필요하지 않도록 코드를 개선하는 편이 더 좋다.

```js
//직원에게 복지 혜택을 받을 자격이 있는지 검사한다.
if((employee.flags & HOURLY_FLAG) && 
   (employee.age>65))
```



```js
if(employee.isEligibleForFullBenefits())
```



### 위치를 표시하는 주석

소스 파일에서 특정 위치를 표시하기 위해 사용하는 주석

```js
// Actions /////////////////////////
```

이러한 주석은 눈에 띄며 주의를 환기할 수 있다. 아주 드물게 사용하는 것이 좋다.



### 닫는 괄호에 다는 주석

중첩이 심하고 장환한 함수라면 의미가 있을 수도 있지만 작고 캡슐화된 함수에는 필요하지 않다. 닫는 괄호에 주석을 달아야 한다고 생각이 되면 함수의 크기를 줄여보자.



### 공로를 돌리거나 저자를 표시하는 주석 

```js
/* 크롱이 추가함 */
function getData(){
  ..
}
```

소스 코드 관리 시스템은 저자를 기억하기 때문에 저자 이름으로 주석을 달지 않는 것이 좋다.



### 주석으로 처리한 코드 

주석으로 처리한 코드를 봤을 때 누군가는 이 코드가 이유가 있어서 남겨놨을 것이라 생각할 수 있다.

소스코드 관리 시스템이 코드를 기억해주기 때문에 주석으로 처리할 필요 없이 삭제하는 것이 좋다. 



### HTML 주석

```js
/*
<p/>
<pre>
용법 :
 ........
 </pre>
 */
 
```

HTML 태그를 삽입해야 하는 책임은 프로그래머가 아니라 도구가 져야한다. 



### 전역 정보

주석을 달아야 한다면 근처에 있는 코드만 기술하라. 코드 일부에 주석을 달면서 시스템의 전반적인 정보를 기술하지 마라.

```js
/*
적합성 테스트가 동작하는 포트 : 기본값은 <b>8082</b>
*/

function setFitnessePort(fitnessePort) {
  const port = fitnessePort;
}

```

함수 자체가 주석에 나와있는 포트 기본값을 통제하지 않음.



### 너무 많은 정보 

주석에다 흥미로운 역사나 관련없는 정보를 장황하게 늘어놓지 마라.



### 모호한 관계

주석과 주석이 설명하는 코드는 둘 사이 관계가 명백해야 한다.

```js
//모든 픽셀을 담을 만큼 충분한 배열로 시작한다. (여기에 필터 바이트를 더한다)
//그리고 헤더 정보를 위해 200바이트를 더한다.
....
```

- 필터 바이트?

- +1과 관련이 있을까 아니면 *3과 관련이 있을까? 아니면 둘 다? 

- 한 픽셀이 한 바이트인가? 

- 200을 추가하는 이유는?

  

### 함수 헤더 

짧고 한 가지만 수행하며 이름을 잘 붙인 함수가 주석으로 헤더를 추가한 함수보다 좋다.



### 비공개 코드에서 Javadocs

Javadocs 주석이 요구하는 형식으로 인해 코드만 보기 싫고 산만해지기 때문에 공개하지 않을 코드라면 Javadocs는 사용하지 않는게 좋다.